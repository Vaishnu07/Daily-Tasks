import json
import requests

headers = {
         "Content-Type": "application/json; charset=utf-8",
         "Cookie": "_call_rpt_session=4874c8fa8e7fac0aed6344142b026cb5; _ga=GA1.2.2091385324.1715353767; visitor_id=f7adee30-e03d-46a0-9af4-8f3bf4def6dd; cognito_user=true; amplify-redirected-from-hosted-ui=true; account_id=704644062; account_name=Liberty%20Home%20Guard; has_ever_logged_in=1; _vwo_uuid_v2=DB7F4B9DA6A5EE7766D753B64FD556DB1|2ce773cebf0722afd016f32ffaaae409; _vwo_uuid=DA4D02017FE5CFDF2A2848DCE6CAC8341; remember_device_token=fae243ed-0e0d-4896-a894-1f5d411d102d; calltrk_user=eyJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3NDczNjgxODcsInBsYW5zIjpbImNhbGxzIl0sImFjdGl2ZV9udW1iZXJzIjo0OTksImFjdGl2ZV9pbnRlZ3JhdGlvbnMiOlsiR29vZ2xlQWR3b3JkIiwiRmFjZWJvb2siLCJCaW5nIl0sImhhc19wY2kiOmZhbHNlfQ.IITjcpXLO-CgEQM2SCkTnYXHuZ4q_gj6JFps6VPNWFQ; CognitoIdentityServiceProvider.45to71h4ai78nd1j1roi2elche.google_117702022248408890050.refreshToken=eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.jCUlPaxzl3gxmC2AlgTJvo0UfyAGRYenKWpE4xmALubQBVRnoEEJaHfio2NYQ0amuc4yno-3hEQoydRBCzOEgcr2OANBx9TGSLlhQcprukhSNo97IqFWfBaMbvMSIrLmIT84-jJCTbs-s7aFS90ZpvNa78BA6SnuDqOtwA2Njl4phFjrCgLzjL2IuwK7WYDn2LyeygbVBOkt_WPGZqFYj8rrUhZHD1t3vJJ4wzNwtMwEI1XY_yQeT4eb3zEuR19DCbxK7tZ4KsihkCjdBgYxWGgY0NXzPM61YcO_bK3uOoOY8ednoa-gSI5lV_ZhwhgLboN-9hC6-ZTpiEJhUroNHg.Fde5RYuccCjuP_u1.-dpH6Q0W8dkx0NIV2DVuBTF0mkYeDMo3HBbGphts9T5nWwQbp3NMDf4Gl2DZlfGlmh99Xtu1J0fhsOFiH_dbbcnyRf6Fr2uyyK6tQwL_w-Q67LA8itUFxng9VvhiYG9BsQQRljKmSJw7VqsfpgGKY5OFO7Q-fhtqd6sPEehdUZ5G1fOR3kINoiBITiFieo4rWQjuanxcpwF-mEeR4hMix28_d2bG-3lkvp8ymOE_s3bXCdTX5VEm4hmLvKRvlFSpqM8zVJmlWUHspHh5Gr_1nJRv7Lf3m1i4uaHrMjiP8oESuQz33s6E_ZDmX8dN0kayXn6Z4vM0RvDdFRhH6uwMeAG8MlMDkwIJfOVjNrszFcxwgBezHz49SZAAN7Mt-IQ6IQXJynC7SeM_qEj_YQfZvHMRQsCt8RLQVdYRooS42v2Hsegd91DehkbXx0StkCtP9d904f7CMWmpEoWdId_dgHegbibbOXMrwKgaO8eGqKrG8yV6IqPMpUqgSMxQtkK879bODr5g7WJwWCeD_EHkwCsraYUUsl1kpMiWiJS2EG0pm4pp7lgMoOIYR3WHwSrMlDpsGcmuUJj-FS1MVmPBVWmESuIKtLH5mnsX21-EhPecQf9pT3lN450Gp8u3s05yGqWnaDVLZOkj26NDQ8doUDeV1ImCy3sXai0E9cB8u9AJMCdJBtvyD1Nq-2miOZE9UJE191FKbYEZSFJR4xoUXAgNkjB1bKbEYijP0nPn2PaGht6PXEYizPZZKqZFlNoQzS_zarsALAp4DvEwf5Uos7-I7klxJ7a3JFrGycEUCDvhiF_LeqVFuDNq_XGhYBWiKKsc_h2dmLMkLh3S-S6I4LiWlSdZBZs7hLx38IbvzWnnVkGErOoMZhWFWZODYDJ8WtfWwv3XoNMnJW9J6aKy_kemEgUJi5xLuuzj5onvfdPi88fnqk9IPkXsCL_oWX_o6hJpYvW6Oi4WXSa4LESDyn41hb1ejjhLXhYpMctLomMGXIyMJo67S_YJHeOrqxRAJDKH2CAZH-wg_dg67tZkpBWzOaaWFJBYZLFaBmgNsult7OwQ8sa7kwqPX5gpCvRo6ZrzcaZKsArZ8WNauZu4DblFliB7rU_D5McPVNe1T58p5XFyDf1xkZQRI89TK1rs4-0ISqDBykPES1DkdAUHTy-Q9kjJJ2mZ4P4Pa8aVFjEtdKSir5RWtu2F_205ipI_4LWaLnz4HEMHDMOYkcBs6HdhC2eGij8QPQi1hWdxIy1BrghAt02jh6-Y_JnCl8AJ2y3r-nwvUMhEBdYSz7YnAhtDSEKg.3a8Y34i6S81hsyjn-CzRkw; CognitoIdentityServiceProvider.45to71h4ai78nd1j1roi2elche.google_117702022248408890050.clockDrift=0; CognitoIdentityServiceProvider.45to71h4ai78nd1j1roi2elche.LastAuthUser=google_117702022248408890050; amplify-signin-with-hostedUI=true; CognitoIdentityServiceProvider.45to71h4ai78nd1j1roi2elche.google_117702022248408890050.userData={%22UserAttributes%22:[{%22Name%22:%22sub%22%2C%22Value%22:%228fc578b8-dee4-4ed1-877e-10403cdb6d1b%22}%2C{%22Name%22:%22identities%22%2C%22Value%22:%22[{%5C%22userId%5C%22:%5C%22117702022248408890050%5C%22%2C%5C%22providerName%5C%22:%5C%22Google%5C%22%2C%5C%22providerType%5C%22:%5C%22Google%5C%22%2C%5C%22issuer%5C%22:null%2C%5C%22primary%5C%22:true%2C%5C%22dateCreated%5C%22:1704461844206}]%22}%2C{%22Name%22:%22email_verified%22%2C%22Value%22:%22false%22}%2C{%22Name%22:%22phone_number_verified%22%2C%22Value%22:%22false%22}%2C{%22Name%22:%22email%22%2C%22Value%22:%22awsdev@libertyhomeguard.com%22}]%2C%22Username%22:%22google_117702022248408890050%22}; builderSessionId=8c5a97e9411b4c00aa81c4a95269b862; CognitoIdentityServiceProvider.45to71h4ai78nd1j1roi2elche.google_117702022248408890050.idToken=eyJraWQiOiJ1VWFKbVBNMHUwT0lBK0ptd2dDcHlQN2NpTXY2cDd5d1h1cWFVUm1HYkFVPSIsImFsZyI6IlJTMjU2In0.eyJhdF9oYXNoIjoieUZTbVJkZ1FvTnNGZk1haDJRSGkxdyIsInN1YiI6IjhmYzU3OGI4LWRlZTQtNGVkMS04NzdlLTEwNDAzY2RiNmQxYiIsImNvZ25pdG86Z3JvdXBzIjpbInVzLWVhc3QtMV9IenBxQ2NFbllfR29vZ2xlIl0sImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLnVzLWVhc3QtMS5hbWF6b25hd3MuY29tXC91cy1lYXN0LTFfSHpwcUNjRW5ZIiwicGhvbmVfbnVtYmVyX3ZlcmlmaWVkIjpmYWxzZSwiY29nbml0bzp1c2VybmFtZSI6Imdvb2dsZV8xMTc3MDIwMjIyNDg0MDg4OTAwNTAiLCJvcmlnaW5fanRpIjoiMzA2NmRmOWYtNzdmZS00ZmNlLTljZDktYjAzYzFkYmMzZjU2IiwiYXVkIjoiNDV0bzcxaDRhaTc4bmQxajFyb2kyZWxjaGUiLCJpZGVudGl0aWVzIjpbeyJ1c2VySWQiOiIxMTc3MDIwMjIyNDg0MDg4OTAwNTAiLCJwcm92aWRlck5hbWUiOiJHb29nbGUiLCJwcm92aWRlclR5cGUiOiJHb29nbGUiLCJpc3N1ZXIiOm51bGwsInByaW1hcnkiOiJ0cnVlIiwiZGF0ZUNyZWF0ZWQiOiIxNzA0NDYxODQ0MjA2In1dLCJ0b2tlbl91c2UiOiJpZCIsImF1dGhfdGltZSI6MTcxNjk4MjkxOCwiZXhwIjoxNzE3MjQ5MTY3LCJpYXQiOjE3MTcxODQzNjcsImp0aSI6IjYwNjVkMjY4LTU4M2MtNDhmYy05M2Y4LTQ1NjUwZjMzMGE5MyIsImVtYWlsIjoiYXdzZGV2QGxpYmVydHlob21lZ3VhcmQuY29tIn0.q5i3AVAFsgahLBtUh-IPW_YB5sPc-BKonI9h5dy0jhoYNexWeG16eGO_Wjp7YEQHUopkDMcIJ-9tll_JvZZTcI0fWmnU8gZdu7n1hQbWZJD8dlLuKXMV30YEIz66VCkvqQ54d0OQQP4ae4WvxW3GFzGjggGgtIvKZwtcCm9LQonlRaI9vws6ZPBRd4YGQXbFnJHEmc1rRxoPCDSXsldbkN6SjDmkiTpOP-HieuDHh52H3UJWu50sFgB5MMgXEz0H-cXe5LeHJMdxeusH4tpc7ATc8wMH8wbwAlNVxTXXuXtFs9WW_Ud77lqdIhlUIxyLExS2L3vI4_L2q5kJNnuvUg; CognitoIdentityServiceProvider.45to71h4ai78nd1j1roi2elche.google_117702022248408890050.accessToken=eyJraWQiOiJnRzBGOTgrcHhcL3o2dVJNbkszaUtwUlFTQnMwb1pyUDZvWFVZZTB1XC9XMkE9IiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiI4ZmM1NzhiOC1kZWU0LTRlZDEtODc3ZS0xMDQwM2NkYjZkMWIiLCJjb2duaXRvOmdyb3VwcyI6WyJ1cy1lYXN0LTFfSHpwcUNjRW5ZX0dvb2dsZSJdLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAudXMtZWFzdC0xLmFtYXpvbmF3cy5jb21cL3VzLWVhc3QtMV9IenBxQ2NFblkiLCJ2ZXJzaW9uIjoyLCJjbGllbnRfaWQiOiI0NXRvNzFoNGFpNzhuZDFqMXJvaTJlbGNoZSIsIm9yaWdpbl9qdGkiOiIzMDY2ZGY5Zi03N2ZlLTRmY2UtOWNkOS1iMDNjMWRiYzNmNTYiLCJ0b2tlbl91c2UiOiJhY2Nlc3MiLCJzY29wZSI6ImF3cy5jb2duaXRvLnNpZ25pbi51c2VyLmFkbWluIHBob25lIG9wZW5pZCBwcm9maWxlIGVtYWlsIiwiYXV0aF90aW1lIjoxNzE2OTgyOTE4LCJleHAiOjE3MTcxODc5NjcsImlhdCI6MTcxNzE4NDM2NywianRpIjoiMDg0Zjg1YmMtMmM3Yi00NzFhLTlhNzktMTg2M2VmZmNhMjkxIiwidXNlcm5hbWUiOiJnb29nbGVfMTE3NzAyMDIyMjQ4NDA4ODkwMDUwIn0.s7tXCuqmKrcve55hYIT-nuxv-4DF_49-7ZHqSsHGSmDptIQh-cdk8BsMiJhQcFo5jJ1K2AN4hPTQML-SWMctxZKq-lYIPmvtV8KYEM34sWBnGNalQtd1bsjoJ7NFII_kASC8iu_ExRA28Naz37QHKC2NfgFSaAHr7y_dxNenrHMfSHDO4K8cHvn1dtf5FEj2ss52XgVC06rbLRx0hzEU49Bf-H3xFnexQPigrXCZqnKRVmHuppJ_sr4Zjd5B20xYABbLNiUAD36qtUiT4WBLTL50DpUhGZA9N24vNv4tlx-di09hQKjozB2ebpyRfuILatcIDYDaz5gXJSK4z2R4Ag; locale=en; _gid=GA1.2.1003233496.1717184374; _vis_opt_s=5%7C; _vis_opt_test_cookie=1; fs_lua=1.1717184375833; fs_uid=#callrail.com#9d2eb180-43f5-4923-9702-0c8676b9505d:4a805c4d-db06-4a02-a36a-01ca879134eb:1717184375833::1#3b4bfcc3#/1746890267; _ga_HC10XK21E5=GS1.2.1717184376.19.0.1717184376.60.0.0; last_visited_url=%2Fanalytics%2Fa%2F704644062%2Freports%2Fcall-list; _dd_s=rum=0&expire=1717185342750; _vwo_sn=1830207%3A4; _vwo_ds=3%3At_0%2Ca_0%3A0%241715354165%3A27.45085612%3A%3A11_0%2C9_0%3A26_0%2C25_0%3A1; CSRF-TOKEN=BoxaKYz0sQyoGANNkv2q%2BA4oXp%2BYGtjMbuY9Quxgq1bMzKoxiaB%2Bk7wca2xZ3g2U6GUdbZwxPKC2p9ndCA7ECw%3D%3D;"
     }
payload = {"filters":{"for_company_sids":[748700824],"for_date_range":{"date_range":"custom","since":"2024-05-13","until":"2024-05-31"}},"config":{"interval":"total","selects":["tracker_details","source","start_time","duration","person_details","city_details","country_details","agent_details","device_type","keywords_details","referrer_domain","referrer_medium","landing_page_details","campaign","value","tag_details","qualified_details"],"metadata":[],"sort":"start_time","sort_direction":"desc"},"page":1,"per_page":None,"cursor_direction":None,"cursor":None,"type":"call-list"}
response = requests.put(url="https://app.callrail.com/a/704644062/reports/aggregations/fetch", data=json.dumps(payload),headers=headers)
print(response.json())
calls_data=[]
total_page = 60
for i in range(1,total_page):
     payload1={"filters":{"for_company_sids":[748700824],"for_date_range":{"date_range":"custom","since":"2024-05-13","until":"2024-05-31"}},"config":{"interval":"total","selects":["tracker_details","source","start_time","duration","person_details","city_details","country_details","agent_details","device_type","keywords_details","referrer_domain","referrer_medium","landing_page_details","campaign","value","tag_details","qualified_details"],"metadata":[],"sort":"start_time","sort_direction":"desc"},"page":i,"per_page":None,"cursor_direction":None,"cursor":None,"type":"call-list"}
     data_response = requests.put(url="https://app.callrail.com/a/704644062/reports/aggregations/fetch",
                             data=json.dumps(payload1), headers=headers)
     data = data_response.json()
     print(data)
     for result in data["results"]:
         calls_data.append(result)
with open("2024MAY13_MAY31_.json", "w") as e:
    for durai in calls_data:
        json.dump(durai, e)
        e.write('\n')
